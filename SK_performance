import pymssql
  
# MSSQL 접속
conn = pymssql.connect(host=r"61.97.14.141", database='TEST-SAPIF', user='wmsa',password='skbt#$erver1')

  
# Connection 으로부터 Cursor 생성
cursor = conn.cursor()

orderno = int(input('order No:'))
lotno = input('batch No:')
itemcode = input('Item code:')

# SQL문 실행
cursor.execute('''
SELECT  itemcode,orderno,lotno, strdate, strtime, enddate, endtime, Cast(CONVERT(DECIMAL(10,2),manhr) as nvarchar) AS manhr, Cast(CONVERT(DECIMAL(10,2),machinehr) as nvarchar) AS machinehr
FROM atE_MakingWorktime
WHERE orderno = %d
OR lotno = '%s' 
OR itemcode = %s;
'''%(orderno, lotno, itemcode))

# 데이타 하나씩 Fetch하여 출력
row = cursor.fetchone()
while row:
    print(row)        
    row = cursor.fetchone()
    
# 연결 끊기
conn.close()		      
